
"use strict"




var fs      = require('fs')





var io      = require('jst/io/io')
var parseJS = require('jst/app/parse-js')





var jst = rawArgs => {

	var args = jst.preprocess(jst.validate(rawArgs))

	if (args.readStdin) {

		io.readStdin((err, fcontent) => {

			if (err && !err.suppressErrors) {
				process.stdeout.err(constants.messages.FAILED_STDIN_LOAD)
			} else {
				parseJS(args, fcontent)
			}

		})

	} else {

		args.paths.forEach(fpath => {

			fs.readFile(fpath, (err, fcontent) => {

				if (err && !err.suppressErrors) {

				}

				parseJS(args, fcontent.toString( ))

			})

		})

	}

}

jst.preprocess = args => {

	return {
		readStdin:      args['-'],
		paths:          args['<path>'],
		suppressErrors: args['-s'] | args['--supress-errors']
	}

}

jst.validate = args => {
	return args
}





module.exports = jst
